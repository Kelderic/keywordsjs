!function(a){a.Keywords=function(){function b(a,b){for(var c in b)a.style[c]=b[c]}function c(a,b){for(var c=0,d=a.length;c<d;c++)if(b==a[c])return c;return-1}function d(a){if("kwjs-keyword"==a.className)return a;for(;"kwjs-keyword"!=a.className&&"body"!=a.nodeName.toLowerCase();)a=a.parentNode;return"body"!=a.tagName.toLowerCase()&&a}var e=function(e){var f=this;if(!1 in e)return!1;f.colors={},"colors"in e&&(f.colors.default="default"in e.colors?e.colors.default:{},f.colors.highlight="highlight"in e.colors?e.colors.highlight:{},"color"in f.colors.default&&(f.colors.default.fill=f.colors.default.color),"color"in f.colors.highlight&&(f.colors.highlight.fill=f.colors.highlight.color)),f.delimiter="delimiter"in e?e.delimiter:" ",f.dragging=!1,f.restrict=!1;for(var g=("choices"in e?e.choices:[]),h='<li class="kwjs-filteredout" style="color:gray;font-style:italic;pointer-events:none">Unallowed</li>',i=0,j=g.length;i<j;i++)h+="<li>"+g[i]+"</li>",f.restrict=!0;f.css=document.createElement("style"),f.css.type="text/css",f.css.innerHTML+=".kwjs-outerwrap { position: relative; } ",f.css.innerHTML+=".kwjs-keywordwrap { pointer-events: none; position: absolute; padding: 4px 0 4px 4px; } ",f.css.innerHTML+=".kwjs-keyword { display: inline-block; vertical-align:bottom; pointer-events: auto; position: relative; border-radius: 2px; box-sizing: border-box; margin-right: 4px; cursor: move } ",f.css.innerHTML+=".kwjs-choiceswrap { position: absolute; top: calc(100% + 2px); left: 0; right: 0; max-height:300px; overflow:auto; list-style: none; margin:0; padding:0; transform: scaleY(0); transform-origin:top; transition:transform 0.2s } ",f.css.innerHTML+=".kwjs-choiceswrap li { cursor:pointer; padding:5px } ",f.css.innerHTML+=".kwjs-choiceswrap li:hover, li.kwjs-highlighted { background:white; } ",f.css.innerHTML+="li.kwjs-alreadychosen, li.kwjs-filteredout { display:none; } ",f.css.innerHTML+=".kwjs-focused .kwjs-choiceswrap { transform:none; } ",document.body.appendChild(f.css),f.el={},f.el.input=document.querySelector(e.selector),f.el.hidden=f.el.input.cloneNode(),f.el.hidden.type="hidden",f.el.input.name="",f.el.input.id="",f.el.input.value="",f.el.outerWrap=document.createElement("div"),f.el.keywordWrap=document.createElement("div"),f.el.template=document.createElement("div"),f.el.template.draggable=!0,f.el.dropzone=document.createElement("div"),f.el.choicesWrap=document.createElement("ul"),f.el.choicesWrap.innerHTML=h,f.el.choicesWrap.tabIndex=-1,f.el.unallowed=f.el.choicesWrap.firstElementChild,f.el.highlightedKeyword=null,f.el.highlightedChoice=null,f.el.beingDragged=null,f.el.outerWrap.className="kwjs-outerwrap",f.el.keywordWrap.className="kwjs-keywordwrap",f.el.template.className="kwjs-keyword",f.el.choicesWrap.className="kwjs-choiceswrap",f.el.dropzone.className="kwjs-keyword kwjs-dropzone";var k=a.getComputedStyle(f.el.input,null);b(f.el.outerWrap,{display:"inline"==k.getPropertyValue("display")?"inline-block":k.getPropertyValue("display")}),b(f.el.keywordWrap,{top:k.getPropertyValue("border-top-width"),left:k.getPropertyValue("border-left-width")}),b(f.el.template,{"padding-left":parseInt(k.getPropertyValue("padding-left"))-2+"px","padding-right":parseInt(k.getPropertyValue("padding-right"))-2+20+"px","font-size":k.getPropertyValue("font-size"),"font-weight":k.getPropertyValue("font-weight"),"font-style":k.getPropertyValue("font-style"),"font-family":k.getPropertyValue("font-family"),"line-height":parseInt(k.getPropertyValue("height"))-8+"px",height:parseInt(k.getPropertyValue("height"))-8+"px"}),b(f.el.choicesWrap,{background:k.getPropertyValue("background"),"background-color":k.getPropertyValue("background-color"),"box-shadow":k.getPropertyValue("box-shadow")}),b(f.el.template,f.colors.default),b(f.el.dropzone,{"padding-left":"2px","padding-right":"2px",height:parseInt(k.getPropertyValue("height"))-8+"px",background:"rgb(30,130,230)",margin:"0 0 0 -4px"}),b(f.el.dropzone,f.colors.highlight),f.el.input.parentNode.insertBefore(f.el.outerWrap,f.el.input.nextSibling),f.el.outerWrap.appendChild(f.el.hidden),f.el.outerWrap.appendChild(f.el.input),f.el.outerWrap.appendChild(f.el.keywordWrap),g.length>0&&f.el.outerWrap.appendChild(f.el.choicesWrap),f.updateKeywordsFromRealString(f.el.hidden.value),f.el.choicesWrap.addEventListener("mousedown",function(b){"li"==b.target.nodeName.toLowerCase()&&f.addKeyword({keyword:b.target.textContent,match:"exact"}),a.setTimeout(function(a){f.el.input.focus()},10)}),f.el.outerWrap.addEventListener("focusin",function(a){f.el.outerWrap.classList.add("kwjs-focused"),f.el.highlightedKeyword&&f.unhighlightKeyword(f.el.highlightedKeyword)}),f.el.outerWrap.addEventListener("focusout",function(b){a.setTimeout(function(a){f.el.outerWrap.contains(document.activeElement)||f.el.outerWrap.classList.remove("kwjs-focused")},20),f.el.input.value&&a.setTimeout(function(a){f.addKeyword({keyword:f.el.input.value,match:"begins-with"})},10)}),f.el.outerWrap.addEventListener("keypress",function(b){1!==b.key.length||b.ctrlKey||(b.key==f.delimiter?(b.preventDefault(),f.el.input.value?a.setTimeout(function(a){f.addKeyword({keyword:f.el.input.value,match:"begins-with"})},10):f.el.highlightedChoice&&(b.preventDefault(),f.addKeyword({keyword:f.el.highlightedChoice.textContent,match:"exact"}))):f.updateFilteredChoicesFromInput(f.el.input.value+b.key))}),f.el.outerWrap.addEventListener("keydown",function(b){if(13==b.which)f.el.input.value&&(b.preventDefault(),a.setTimeout(function(a){f.addKeyword({keyword:f.el.input.value,match:"begins-with"})},10)),f.el.highlightedChoice&&(b.preventDefault(),f.addKeyword({keyword:f.el.highlightedChoice.textContent,match:"exact"}));else if(8==b.which)if(!f.el.input.value&&f.el.keywordWrap.children.length>0)if(b.preventDefault(),f.el.highlightedKeyword){var d=f.el.highlightedKeyword;d.previousElementSibling?f.highlightKeyword(d.previousElementSibling):f.el.input.focus(),f.removeKeyword(d)}else f.highlightKeyword(f.el.keywordWrap.lastChild);else a.setTimeout(function(a){f.updateFilteredChoicesFromInput(f.el.input.value)},10);else if(46==b.which)if(!f.el.input.value&&f.el.keywordWrap.children.length>0){if(f.el.highlightedKeyword){var d=f.el.highlightedKeyword;d.nextElementSibling?f.highlightKeyword(d.nextElementSibling):f.el.input.focus(),f.removeKeyword(d)}}else a.setTimeout(function(a){f.updateFilteredChoicesFromInput(f.el.input.value)},10);else if(37==b.which){if(!f.el.input.value&&f.el.keywordWrap.children.length>0)if(f.el.highlightedKeyword){var d=f.el.highlightedKeyword;d.previousElementSibling&&(f.unhighlightKeyword(d),f.highlightKeyword(d.previousElementSibling))}else f.highlightKeyword(f.el.keywordWrap.lastChild)}else if(39==b.which){if(!f.el.input.value&&f.el.keywordWrap.children.length>0&&f.el.highlightedKeyword){var d=f.el.highlightedKeyword;f.unhighlightKeyword(d),d.nextElementSibling?f.highlightKeyword(d.nextElementSibling):f.el.input.focus()}}else if(38==b.which||40==b.which){b.preventDefault();var e,g=f.el.choicesWrap.querySelectorAll(":not(.kwjs-alreadychosen):not(.kwjs-filteredout)");f.el.highlightedKeyword||(f.el.highlightedChoice?(e=c(g,f.el.highlightedChoice),e=38==b.which?e-1:e+1,e<0?f.highlightChoice(null):e<g.length&&f.highlightChoice(g[e])):f.highlightChoice(38==b.which?null:g[0]))}}),f.el.outerWrap.addEventListener("paste",function(b){a.setTimeout(function(a){f.updateFilteredChoicesFromInput(f.el.input.value)},10)}),f.el.keywordWrap.addEventListener("click",function(a){"button"==a.target.nodeName.toLowerCase()&&(f.removeKeyword(a.target.parentNode),f.el.input.focus())}),f.el.keywordWrap.addEventListener("dragstart",function(a){var b=d(a.target);b&&(a.dataTransfer.setData("text/html",b),f.el.beingDragged=b,f.dragging=!0,f.el.highlightedKeyword&&f.unhighlightKeyword(f.el.highlightedKeyword))}),document.addEventListener("dragover",function(a){if(a.preventDefault(),f.dragging){var b=d(a.target);if(b&&!b.classList.contains("kwjs-dropzone")){var c=b.getBoundingClientRect(),e=c.x+c.width/2;a.clientX-e>0?f.el.keywordWrap.insertBefore(f.el.dropzone,b.nextElementSibling):f.el.keywordWrap.insertBefore(f.el.dropzone,b)}}}),document.addEventListener("drop",function(a){console.log(a),a.preventDefault(),f.dragging&&(f.dragging=!1,f.el.keywordWrap.insertBefore(f.el.beingDragged,f.el.dropzone),f.el.keywordWrap.removeChild(f.el.dropzone),f.el.hidden.value=f.buildRealStringFromKeywords())}),document.addEventListener("dragover",function(a){f.dragging&&a.preventDefault()})};return e.prototype.addKeyword=function(a){var b=this,c="keyword"in a?a.keyword:"",d="match"in a?a.match:"exact";if(""!=c)if(b.restrict&&"begins-with"==d&&(c=b.autoCompleteKeyword(c)),""==c)b.el.input.value="",b.updateFilteredChoicesFromInput(b.el.input.value);else{var e=b.el.template.cloneNode();e.innerHTML=c+'<button type="button" tabindex="-1" style="appearance:none; fill:inherit; color:inherit; font-size:0; background:transparent; border:none; box-shadow:none; cursor:pointer; position:absolute; top:calc(50% - 10px); right:2px; padding:4px; height:auto; width:auto;"><svg style="pointer-events:none;height:14px;width:14px;" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 16 16"><polygon points="15,3 13,1 8,6 3,1 1,3 6,8 1,13 3,15 8,10 13,15 15,13 10,8 "/></svg></button>',b.el.keywordWrap.appendChild(e),b.el.input.style["padding-left"]=b.el.keywordWrap.offsetWidth+6+"px",b.el.hidden.value=b.buildRealStringFromKeywords(),b.el.input.value="",b.restrict&&(b.updateAlreadyChosenChoicesFromKeywords(),b.updateFilteredChoicesFromInput(b.el.input.value))}},e.prototype.removeKeyword=function(a){var b=this;b.el.keywordWrap.removeChild(a),b.el.input.style["padding-left"]=b.el.keywordWrap.offsetWidth+6+"px",b.el.hidden.value=b.buildRealStringFromKeywords(),b.restrict&&b.updateAlreadyChosenChoicesFromKeywords()},e.prototype.highlightKeyword=function(a){var c=this;b(a,c.colors.highlight),c.el.input.blur(),a.firstElementChild.focus(),c.el.highlightedKeyword=a},e.prototype.unhighlightKeyword=function(a){var c=this;b(a,c.colors.default),c.el.highlightedKeyword=null},e.prototype.buildRealStringFromKeywords=function(){for(var a=this,b="",c=a.el.keywordWrap.children,d=0,e=c.length;d<e;d++)b+=c[d].textContent+a.delimiter;return b},e.prototype.updateKeywordsFromRealString=function(a){var b=this;if(b.el.keywordWrap.innerHTML="",a.trim())for(var c=a.trim().split(b.delimiter),d=0,e=c.length;d<e;d++)b.addKeyword({keyword:c[d],match:"exact"})},e.prototype.updateAlreadyChosenChoicesFromKeywords=function(){for(var a=this,b=a.el.choicesWrap.children,c=1,d=b.length;c<d;c++)a.el.hidden.value.indexOf(b[c].textContent)>-1?b[c].classList.add("kwjs-alreadychosen"):b[c].classList.remove("kwjs-alreadychosen")},e.prototype.updateFilteredChoicesFromInput=function(a){var b=this;if(b.restrict){var c,d,e=!1;c=b.el.choicesWrap.querySelectorAll(":not(.kwjs-alreadychosen)");for(var f=1,g=c.length;f<g;f++)d=c[f].textContent.toLowerCase(),a=a.toLowerCase(),0==d.indexOf(a)?(c[f].classList.remove("kwjs-filteredout"),e=!0):c[f].classList.add("kwjs-filteredout");b.el.highlightedChoice&&(b.el.highlightedChoice.classList.remove("kwjs-highlighted"),b.el.highlightedChoice=null),e?b.el.unallowed.classList.add("kwjs-filteredout"):b.el.unallowed.classList.remove("kwjs-filteredout")}},e.prototype.autoCompleteKeyword=function(a){var b=this;if(!b.restrict)return!0;var d,e;return d=b.el.choicesWrap.querySelectorAll(":not(:first-child):not(.kwjs-alreadychosen):not(.kwjs-filteredout)"),d.length>0?(e=b.el.highlightedChoice?c(d,b.el.highlightedChoice):0,d[e].textContent):""},e.prototype.highlightChoice=function(a){var b=this;b.el.highlightedChoice&&b.el.highlightedChoice.classList.remove("kwjs-highlighted"),a&&a.classList.add("kwjs-highlighted"),b.el.highlightedChoice=a},e}()}(window);